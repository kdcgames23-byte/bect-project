<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Publier un niveau - BECT</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header><h1>Publier un niveau</h1></header>
<div class="container">
<input type="text" id="title" placeholder="Titre du niveau">
<textarea id="description" placeholder="Description"></textarea>
<input type="file" id="jsonFile" accept=".json">
<input type="file" id="images" accept="image/*" multiple>
<button id="publishBtn">Publier maintenant</button>
</div>

<script>
const API_URL="https://TON_BACKEND_URL"; // Remplace par ton URL Vercel
const token=localStorage.getItem("token");
if(!token) window.location.href="login.html";

document.getElementById("publishBtn").addEventListener("click", async ()=>{
  const formData=new FormData();
  formData.append("title",document.getElementById("title").value);
  formData.append("description",document.getElementById("description").value);
  formData.append("jsonFile",document.getElementById("jsonFile").files[0]);
  const images=document.getElementById("images").files;
  for(let i=0;i<images.length;i++) formData.append("images",images[i]);

  const res=await fetch(`${API_URL}/api/upload`,{
    method:"POST",
    headers:{Authorization:`Bearer ${token}`},
    body:formData
  });
  const data=await res.json();
  if(data.ok){ alert("Niveau publiÃ© !"); window.location.href="index.html"; }else alert(data.error);
});
</script>
</body>
</html>
